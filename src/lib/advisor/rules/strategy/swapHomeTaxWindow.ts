/**
 * ××¡×˜×¨×˜×’×™×”: ×—×œ×•×Ÿ ×“×™×¨×” ×—×œ×™×¤×™×ª
 *
 * ×ª× ××™: 2+ × ×›×¡×™ × ×“×œ"×Ÿ, ×¨×›×™×©×ª × ×›×¡ ×‘-18 ×—×•×“×©×™× ××—×¨×•× ×™×
 * ×§×˜×’×•×¨×™×”: strategy
 */

import { createRule } from '../../ruleFactory';
import {
  getRealEstateCount,
  boughtPropertyRecently,
} from '../../helpers';

export default createRule({
  id: 'swap-home-tax-window',
  name: '×—×œ×•×Ÿ ×“×™×¨×” ×—×œ×™×¤×™×ª',

  condition: (ctx) => {
    // ×™×© ×œ×¤×—×•×ª 2 × ×›×¡×™ × ×“×œ"×Ÿ
    if (getRealEstateCount(ctx) < 2) return false;

    // ×¨×›×© × ×›×¡ ×‘-18 ×—×•×“×©×™× ××—×¨×•× ×™×
    if (!boughtPropertyRecently(ctx, 18)) return false;

    return true;
  },

  recommendation: {
    title: '×—×œ×•×Ÿ ×”×–×× ×™× ×œ××›×™×¨×ª ×“×™×¨×” ×™×©× ×”',
    description: `×–×™×”×™× ×• ×©×¨×›×©×ª ×“×™×¨×” × ×•×¡×¤×ª ×œ××—×¨×•× ×”. ×›×“×™ ×œ×”×™×—×©×‘ ×›×‘×¢×œ "×“×™×¨×” ×™×—×™×“×”" ×•×œ×”×™×× ×¢ ×××¡ ×¨×›×™×©×” ×’×‘×•×” ×•××¡ ×©×‘×—, ×¢×œ×™×š ×œ××›×•×¨ ××ª ×”×“×™×¨×” ×”×™×©× ×” ×‘×ª×•×š 18 ×—×•×“×©×™× ×××•×¢×“ ×”×¨×›×™×©×”.

âš ï¸ ×œ××” ×–×” ×§×¨×™×˜×™:
â€¢ ××¡ ×¨×›×™×©×” ×¢×œ ×“×™×¨×” ×©× ×™×™×”: 8% (×‘××§×•× 0-0.5%)
â€¢ ××¡ ×©×‘×— ××œ× ×¢×œ ×”×“×™×¨×” ×”×™×©× ×” (×œ×œ× ×¤×˜×•×¨ ×“×™×¨×” ×™×—×™×“×”)

ğŸ“… ××” ×œ×¢×©×•×ª:
â€¢ ×œ×‘×“×•×§ ××ª ×ª××¨×™×š ×¨×›×™×©×ª ×”×“×™×¨×” ×”×—×“×©×”
â€¢ ×œ×ª×›× ×Ÿ ××›×™×¨×ª ×”×“×™×¨×” ×”×™×©× ×” ×‘×˜×•×•×— ×”×–××Ÿ
â€¢ ×œ×”×ª×™×™×¢×¥ ×¢× ×™×•×¢×¥ ××¡ ×œ×’×‘×™ ×¡×“×¨ ×”×¤×¢×•×œ×•×ª ×”××•×¤×˜×™××œ×™`,
    type: 'tax_benefit',
    priority: 'high',
    category: 'strategy',
    actionUrl: 'https://www.gov.il/he/service/mas_shevach_calculator',
    potentialValue: 100000,
  },

  getEligibilityReason: (ctx) => {
    const count = getRealEstateCount(ctx);
    return `${count} × ×›×¡×™ × ×“×œ"×Ÿ ×‘×‘×¢×œ×•×ª×š, ×¨×›×™×©×” ××—×¨×•× ×” ×‘-18 ×—×•×“×©×™× ×”××—×¨×•× ×™× - ×—×œ×•×Ÿ ×”×”×–×“×× ×•×™×•×ª ×¤×ª×•×—`;
  },
});
