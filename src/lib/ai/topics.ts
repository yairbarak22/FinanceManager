/**
 * AI Help Topics Registry
 * מאגר נושאים לעזרה חינוכית ממוקדת
 */

export interface AITopic {
  id: string;
  title: string;
  description: string;
  educationalContext: string;
  suggestedQuestions: string[];
}

/**
 * All available help topics with their educational contexts
 */
export const AI_TOPICS: Record<string, AITopic> = {
  // ============ נכסים ============
  assets: {
    id: 'assets',
    title: 'נכסים',
    description: 'הבנת נכסים פיננסיים',
    educationalContext: `
אתה מסביר למשתמש על נכסים פיננסיים. הסבר בצורה פשוטה וידידותית:

מהם נכסים?
- נכס הוא כל דבר בעל ערך כספי שבבעלותך
- נכסים מייצגים את העושר שלך ואת היכולת הכלכלית שלך

סוגי נכסים עיקריים:
1. מזומן וחסכונות - כסף נזיל בבנק, פיקדונות, קרנות כספיות
2. השקעות - מניות, אג"ח, קרנות נאמנות, קופות גמל
3. נדל"ן - דירה, בית, קרקע, נכס מסחרי
4. פנסיה וביטוח - קרן פנסיה, ביטוח מנהלים, קרן השתלמות
5. רכב ורכוש - מכונית, תכשיטים, אומנות

למה חשוב לעקוב אחרי נכסים?
- מאפשר לחשב את השווי הנקי שלך (נכסים פחות התחייבויות)
- עוזר לתכנן פרישה ויעדים פיננסיים
- מראה את הפילוח של העושר שלך

טיפים להוספת נכסים:
- הוסף את כל הנכסים שיש להם ערך כספי משמעותי
- עדכן ערכים מעת לעת (במיוחד השקעות ונדל"ן)
- אל תשכח נכסים "נסתרים" כמו פנסיה וביטוחים
`,
    suggestedQuestions: [
      'מה זה נכסים?',
      'איזה נכסים כדאי להוסיף?',
      'מה ההבדל בין סוגי הנכסים?',
      'איך מחשבים שווי נקי?',
      'מה זה נכס נזיל?',
      'האם פנסיה נחשבת נכס?',
      'למה חשוב לעקוב אחרי נכסים?',
    ],
  },

  // ============ התחייבויות ============
  liabilities: {
    id: 'liabilities',
    title: 'התחייבויות',
    description: 'הבנת הלוואות וחובות',
    educationalContext: `
אתה מסביר למשתמש על התחייבויות והלוואות. הסבר בצורה פשוטה:

מהן התחייבויות?
- התחייבות היא כל חוב שאתה חייב לגורם אחר
- זה כסף שתצטרך להחזיר בעתיד

סוגי התחייבויות עיקריים:
1. משכנתא - הלוואה לרכישת דירה, בדרך כלל הארוכה והגדולה ביותר
2. הלוואות בנקאיות - הלוואות אישיות מהבנק
3. הלוואות לרכב - מימון לרכישת רכב
4. אשראי צרכני - הלוואות חוץ-בנקאיות, כרטיסי אשראי
5. הלוואות מקרן השתלמות - הלוואה כנגד החיסכון

מושגים חשובים:
- קרן: הסכום המקורי שלווית
- ריבית: העלות של ההלוואה (באחוזים)
- תקופת ההלוואה: כמה זמן יש להחזיר
- החזר חודשי: הסכום שמשלמים כל חודש

למה חשוב לעקוב אחרי התחייבויות?
- לדעת כמה חוב יש לך בסך הכל
- לתכנן את התזרים החודשי
- לזהות הזדמנויות למיחזור או פירעון מוקדם
`,
    suggestedQuestions: [
      'מה זה התחייבויות?',
      'מה ההבדל בין משכנתא להלוואה?',
      'איך יודעים אם יש יותר מדי חובות?',
      'מה זה ריבית על הלוואה?',
      'מה זה קרן ומה זה ריבית?',
      'מתי כדאי לעשות מיחזור?',
      'מה זה פירעון מוקדם?',
    ],
  },

  // ============ הלוואת שפיצר ============
  spitzer: {
    id: 'spitzer',
    title: 'הלוואת שפיצר',
    description: 'הבנת שיטת שפיצר לחישוב הלוואות',
    educationalContext: `
אתה מסביר למשתמש על הלוואת שפיצר. הסבר בצורה פשוטה עם דוגמאות:

מהי שיטת שפיצר?
- שיטה לחישוב החזר חודשי קבוע לאורך כל תקופת ההלוואה
- נקראת על שם הכלכלן האוסטרי ד"ר שפיצר

איך זה עובד?
- התשלום החודשי קבוע (לא משתנה)
- בהתחלה: רוב התשלום הולך לריבית, מעט לקרן
- לקראת הסוף: רוב התשלום הולך לקרן, מעט לריבית

הנוסחה:
PMT = P × [r(1+r)^n] / [(1+r)^n - 1]
כאשר:
- P = סכום ההלוואה (קרן)
- r = ריבית חודשית (ריבית שנתית / 12 / 100)
- n = מספר התשלומים (חודשים)

שפיצר vs קרן שווה:
שפיצר:
✓ תשלום חודשי קבוע וצפוי
✓ קל לתכנון תקציבי
✗ משלמים יותר ריבית בסך הכל

קרן שווה:
✓ משלמים פחות ריבית בסך הכל
✓ התשלומים יורדים עם הזמן
✗ תשלומים גבוהים בהתחלה

דוגמה מספרית:
הלוואה של 100,000₪, ריבית 5% שנתית, ל-5 שנים (60 חודשים):
- שפיצר: תשלום קבוע של 1,887₪ לחודש
- סה"כ תשלמו: 113,227₪ (13,227₪ ריבית)
`,
    suggestedQuestions: [
      'מה זה הלוואת שפיצר?',
      'מה ההבדל בין שפיצר לקרן שווה?',
      'מה עדיף - שפיצר או קרן שווה?',
      'איך מחשבים תשלום חודשי?',
      'מה זה לוח סילוקין?',
      'למה משלמים יותר ריבית בהתחלה?',
      'מה זה החזר קבוע?',
    ],
  },

  // ============ ריבית ============
  interest: {
    id: 'interest',
    title: 'ריבית',
    description: 'הבנת סוגי ריבית וחישובים',
    educationalContext: `
אתה מסביר למשתמש על ריבית. הסבר בצורה פשוטה עם דוגמאות:

מהי ריבית?
- ריבית היא "המחיר של כסף"
- כשלווים: זה העלות שמשלמים על ההלוואה
- כשחוסכים: זה הרווח שמקבלים על החיסכון

סוגי ריבית:
1. ריבית נומינלית (פשוטה)
   - האחוז המוצהר על ההלוואה/חיסכון
   - לדוגמה: "ריבית של 5% שנתית"

2. ריבית אפקטיבית
   - הריבית האמיתית אחרי חישוב תדירות הצבירה
   - תמיד גבוהה יותר מהנומינלית
   - דוגמה: 5% נומינלית עם צבירה חודשית = 5.12% אפקטיבית

3. ריבית דריבית (ריבית מצטברת)
   - ריבית על הקרן + ריבית על ריבית קודמת
   - זה מה שגורם לכסף "לעבוד בשבילך"
   - נוסחה: FV = PV × (1 + r)^n

ריבית קבועה vs משתנה:
קבועה:
✓ יציבות וודאות
✓ קל לתכנן
✗ לא נהנים מירידת ריבית במשק

משתנה:
✓ נהנים מירידת ריבית
✗ סיכון לעליית ריבית
✗ קשה לתכנן ארוך טווח

טיפ חשוב:
- בהלוואות: ריבית נמוכה = עדיף
- בחיסכון: ריבית גבוהה = עדיף
`,
    suggestedQuestions: [
      'מה זה ריבית?',
      'מה ההבדל בין ריבית קבועה למשתנה?',
      'מה זה ריבית דריבית?',
      'איך משווים ריביות בין הלוואות?',
      'מה זה ריבית אפקטיבית?',
      'למה ריבית חשובה בהלוואה?',
      'מה זה ריבית פריים?',
    ],
  },

  // ============ השקעות ופילוח ============
  investments: {
    id: 'investments',
    title: 'השקעות ופילוח',
    description: 'הבנת פילוח השקעות ותיק השקעות',
    educationalContext: `
אתה מסביר למשתמש על השקעות ופילוח תיק. הסבר בצורה פשוטה:

מהו פילוח השקעות (Asset Allocation)?
- חלוקת הכסף בין סוגי נכסים שונים
- המטרה: לאזן בין סיכון לתשואה

למה פילוח חשוב?
- "אל תשים את כל הביצים בסל אחד"
- מפחית סיכון כולל
- מאפשר ליהנות מעליות בשווקים שונים

סוגי נכסים להשקעה:
1. מניות - סיכון גבוה, פוטנציאל תשואה גבוה
2. אג"ח - סיכון נמוך-בינוני, תשואה יציבה
3. מזומן - אין סיכון, תשואה נמוכה
4. נדל"ן - סיכון בינוני, הכנסה פסיבית
5. סחורות - זהב, נפט וכו'

פילוח לפי גיל (כלל אצבע):
- אחוז מניות = 100 - גילך
- גיל 30: 70% מניות, 30% אג"ח
- גיל 50: 50% מניות, 50% אג"ח
- גיל 70: 30% מניות, 70% אג"ח

מה זה איזון מחדש (Rebalancing)?
- כשההשקעות עולות/יורדות, הפילוח משתנה
- איזון מחדש = חזרה לפילוח המקורי
- מומלץ לעשות פעם בשנה או כשיש סטייה גדולה
`,
    suggestedQuestions: [
      'מה זה פילוח השקעות?',
      'למה חשוב לפזר השקעות?',
      'איזה פילוח מתאים לי?',
      'מה זה איזון מחדש?',
      'מה ההבדל בין מניות לאג"ח?',
      'מה זה סיכון בהשקעות?',
      'איך מתחילים להשקיע?',
    ],
  },

  // ============ תזרים מזומנים ============
  cashflow: {
    id: 'cashflow',
    title: 'תזרים מזומנים',
    description: 'הבנת הכנסות והוצאות',
    educationalContext: `
אתה מסביר למשתמש על תזרים מזומנים. הסבר בצורה פשוטה:

מהו תזרים מזומנים?
- ההפרש בין ההכנסות להוצאות בתקופה מסוימת
- תזרים = הכנסות - הוצאות

סוגי תזרים:
1. תזרים חיובי (עודף)
   - מכניסים יותר ממה שמוציאים
   - אפשר לחסוך ולהשקיע
   
2. תזרים שלילי (גירעון)
   - מוציאים יותר ממה שמכניסים
   - צריך לקחת מחסכונות או להילוות

למה חשוב לעקוב?
- להבין לאן הולך הכסף
- לזהות הוצאות מיותרות
- לתכנן חיסכון והשקעות
- להימנע מחריגות באשראי

כללי אצבע:
- 50% הוצאות הכרחיות (דיור, אוכל, ביטוחים)
- 30% הוצאות שוטפות (בילויים, קניות)
- 20% חיסכון והשקעות

שיעור חיסכון:
- שיעור חיסכון = (הכנסות - הוצאות) / הכנסות × 100
- שיעור של 20% ומעלה נחשב מצוין
- שיעור שלילי = גירעון - צריך לטפל!
`,
    suggestedQuestions: [
      'מה זה תזרים מזומנים?',
      'איך משפרים את התזרים?',
      'כמה כדאי לחסוך בחודש?',
      'איך מזהים הוצאות מיותרות?',
      'מה זה תקציב 50/30/20?',
      'איך עוקבים אחרי הוצאות?',
      'מה עושים כשיש גירעון?',
    ],
  },

  // ============ המלצות פיננסיות ============
  recommendation: {
    id: 'recommendation',
    title: 'הבנת המלצה',
    description: 'הסבר על הטבות וזכאות',
    educationalContext: `
אתה מסביר המלצה פיננסית ללקוח. בהקשר שלך יש מידע על ההמלצה הספציפית.

כיצד להסביר:
1. הסבר מה ההטבה/ההמלצה ולמה היא חשובה
2. פרט את התנאים לזכאות (השתמש בנתונים שיש לך)
3. הסבר איך לממש את ההטבה בפועל
4. ציין את הערך הכספי המשוער אם זמין
5. ספק קישור למידע נוסף אם יש

סוגי המלצות:
- הטבת מס: הטבות ממס הכנסה, זיכויים ופטורים
- חיסכון: הזדמנויות לחסוך כסף
- ביטוח: המלצות לגבי כיסויים ביטוחיים
- בנקאות: שיפור תנאי בנק, עמלות, הלוואות
- כללי: המלצות פיננסיות אחרות

חשוב:
- השתמש בנתוני הזכאות הספציפיים של הלקוח אם זמינים
- הסבר בשפה פשוטה ונגישה
- תן צעדים קונקרטיים למימוש
- אל תשכח שאתה לא מחליף ייעוץ מקצועי
`,
    suggestedQuestions: [
      'למה אני זכאי להטבה הזו?',
      'מה בדיוק התנאים לזכאות?',
      'איך אני מממש את זה?',
      'כמה כסף אני יכול לחסוך?',
      'עד מתי אפשר לממש את ההטבה?',
      'לאיזה גוף צריך לפנות?',
      'איזה מסמכים צריך להגיש?',
      'כמה זמן לוקח התהליך?',
    ],
  },

  // ============ טופס הלוואה ============
  loan_form: {
    id: 'loan_form',
    title: 'חישוב הלוואה',
    description: 'עזרה במילוי פרטי הלוואה',
    educationalContext: `
אתה עוזר למשתמש למלא טופס הלוואה. הסבר את השדות:

שדות הטופס:
1. שם ההתחייבות - שם תיאורי (למשל: "משכנתא לדירה", "הלוואה לרכב")

2. סוג התחייבות:
   - משכנתא: הלוואה לרכישת נדל"ן
   - הלוואה: הלוואה אישית כללית
   - אשראי צרכני: הלוואות חוץ-בנקאיות

3. שיטת ההלוואה:
   - שפיצר: תשלום חודשי קבוע (הנפוץ ביותר)
   - קרן שווה: תשלום יורד עם הזמן

4. סכום הלוואה: הסכום הכולל שלווית

5. ריבית שנתית: הריבית המוצהרת (באחוזים)

6. תקופה בחודשים: כמה חודשים להחזר

7. תשלום חודשי: אפשר לחשב אוטומטית עם כפתור "חשב"

8. זיכוי על הריבית: 
   - רלוונטי למשכנתא עם החזר מס
   - אם פעיל, רק הקרן נספרת כהוצאה

אם יש לך נתונים מהטופס, אני יכול לחשב עבורך:
- תשלום חודשי
- סה"כ תשלומים
- סה"כ ריבית שתשלם
`,
    suggestedQuestions: [
      'כמה אשלם בסך הכל?',
      'כמה ריבית אשלם?',
      'מה עדיף - שפיצר או קרן שווה?',
      'איך אדע אם ההלוואה משתלמת?',
      'מה זה זיכוי על ריבית?',
      'איך מחשבים החזר חודשי?',
      'מה זה לוח סילוקין?',
    ],
  },
};

/**
 * Get a topic by ID
 */
export function getTopic(topicId: string): AITopic | undefined {
  return AI_TOPICS[topicId];
}

/**
 * Get default topic for fallback
 */
export function getDefaultTopic(): AITopic {
  return {
    id: 'general',
    title: 'עזרה כללית',
    description: 'עזרה פיננסית כללית',
    educationalContext: `
אתה יועץ פיננסי ידידותי שעוזר למשתמשים להבין מושגים פיננסיים.
ענה בצורה פשוטה, ברורה ותמציתית.
השתמש בדוגמאות כשאפשר.
`,
    suggestedQuestions: [
      'מה זה שווי נקי?',
      'איך מתחילים לחסוך?',
      'מה חשוב לדעת על כסף?',
      'מה ההבדל בין חיסכון להשקעה?',
      'איך בונים תקציב?',
      'מה זה קרן חירום?',
    ],
  };
}

